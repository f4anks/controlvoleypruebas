<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>CV Atletas</title><script src="https://cdn.tailwindcss.com"></script><style>:root{--m:#001F3F;--e:#0074D9;--f:#f0f8ff}body{font-family:Inter,sans-serif;background:var(--f)}.b-h{background-image:url('img/banner.png');background-size:cover;background-position:center;min-height:200px;width:100%}.t-h{background:var(--m);color:#fff}.s-h{cursor:pointer}</style></head><body><div class="b-h"></div><div class="container mx-auto p-4"><header class="mb-6 flex justify-between items-center border-b pb-4 relative"><a href="index_menu.html" class="text-gray-600 p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z"/></svg></a><h1 class="text-2xl font-black text-center flex-grow">Gestión Atletas</h1><button onclick="logout()" class="py-1 px-3 bg-red-600 text-white rounded text-sm">Salir</button></header><div class="bg-white p-5 rounded-xl shadow-md mb-6"><h2 id="fT" class="text-xl font-bold mb-4 text-blue-700">Registro Atleta</h2><form id="aF" onsubmit="hS(event)"><input type="hidden" id="aI"><div class="grid grid-cols-1 md:grid-cols-4 gap-3"><div><label class="text-xs">Nombre</label><input type="text" id="no" required class="w-full border p-1 rounded"></div><div><label class="text-xs">Apellido</label><input type="text" id="ap" required class="w-full border p-1 rounded"></div><div><label class="text-xs">Cédula</label><input type="text" id="ci" required class="w-full border p-1 rounded"></div><div><label class="text-xs">Teléfono</label><input type="number" id="te" required class="w-full border p-1 rounded"></div></div><div class="grid grid-cols-2 md:grid-cols-5 gap-3 mt-3"><div><label class="text-xs">Nacimiento</label><input type="date" id="fN" required class="w-full border p-1 rounded text-sm"></div><div><label class="text-xs">Cat</label><select id="ca" class="w-full border p-1 rounded text-sm"><option>U9</option><option>U11</option><option>U13</option><option>U15</option><option>U19</option><option>Master</option></select></div><div><label class="text-xs">Nro</label><input type="number" id="nc" class="w-full border p-1 rounded"></div><div><label class="text-xs">Peso</label><input type="number" id="pe" step="0.1" class="w-full border p-1 rounded"></div><div><label class="text-xs">Talla</label><input type="number" id="ta" step="0.01" class="w-full border p-1 rounded"></div></div><div class="grid grid-cols-1 md:grid-cols-4 gap-3 mt-3 p-3 bg-blue-50 rounded"><div><label class="text-xs">Estado</label><select id="tN" class="w-full border p-1 rounded text-sm"><option value="activo">Activo</option><option value="reposo">Reposo</option><option value="suspendido">Suspendido</option></select></div><div><label class="text-xs">Frecuencia</label><select id="fP" onchange="uL()" class="w-full border p-1 rounded text-sm"><option value="mensual">Mensual</option><option value="quincenal">Quincenal</option></select></div><div><label id="lM" class="text-xs">Monto Mensual</label><input type="number" id="mP" step="0.1" class="w-full border p-1 rounded"></div><div><label class="text-xs">Último Pago</label><input type="date" id="uP" class="w-full border p-1 rounded text-sm"></div></div><div class="flex space-x-2 mt-4"><button type="submit" id="sB" class="bg-blue-900 text-white px-4 py-2 rounded font-bold text-sm">Guardar</button><button type="button" onclick="rF()" class="bg-gray-200 px-4 py-2 rounded text-sm">Cancelar</button></div></form></div><div class="bg-white rounded-xl shadow overflow-x-auto"><table class="w-full text-left text-sm"><thead class="t-h"><tr><th class="p-3">Nombre</th><th>Cédula</th><th>Cat</th><th>#</th><th>Edad</th><th class="text-center">Nómina</th><th>Solvencia</th><th>Acciones</th></tr></thead><tbody id="tB" class="divide-y"></tbody></table></div></div><script type="module">import{initializeApp as iA}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";import{getAuth as gA,onAuthStateChanged as oA,signOut as sO}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";import{getFirestore as gF,collection as cL,doc as dO,onSnapshot as oS,addDoc as aD,updateDoc as uD,deleteDoc as dD,query as qR,where as wH,getDoc as gD}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";const cF={apiKey:"AIzaSyB5RB7mm1j-0gjCNTUEJTkyEqLjyZ3C7ws",authDomain:"datacontrolvoley-ff556.firebaseapp.com",projectId:"datacontrolvoley-ff556",storageBucket:"datacontrolvoley-ff556.firebasestorage.app",messagingSenderId:"516409072606",appId:"1:516409072606:web:132538dba358a077d71b4f"},app=iA(cF),auth=gA(app),db=gF(app);let tI=null,cA=[];const _=id=>document.getElementById(id);window.uL=()=>{const f=_('fP').value;_('lM').innerText=f==='mensual'?'Monto Mensual':'Monto Quincenal'};const cE=d=>{if(!d)return'N/A';const b=new Date(d),n=new Date();let a=n.getFullYear()-b.getFullYear();if(n.getMonth()<b.getMonth()||(n.getMonth()===b.getMonth()&&n.getDate()<b.getDate()))a--;return a};const cS=(f,p)=>{if(!f)return{s:'Insolvente',c:'bg-red-100 text-red-800'};const d=(new Date()-new Date(f))/(864e5),l=p==='quincenal'?15:30;return d<=l?{s:'Solvente',c:'bg-green-100 text-green-800'}:{s:'Insolvente',c:'bg-yellow-100 text-yellow-800'}};const rT=a=>{const b=_('tB');b.innerHTML='';a.forEach(x=>{const s=cS(x.uP,x.fP),l=x.tN.charAt(0).toUpperCase()+x.tN.slice(1),q=x.fP==='quincenal'?' (Q)':' (M)';b.insertAdjacentHTML('beforeend',`<tr class="hover:bg-gray-50"><td class="p-3">${x.no} ${x.ap}</td><td>${x.ci}</td><td>${x.ca}</td><td class="font-bold text-blue-600">${x.nc||'-'}</td><td>${cE(x.fN)}</td><td class="text-center"><span class="px-2 py-0.5 rounded-full text-[10px] font-bold bg-blue-100 text-blue-800">${l}${q}</span></td><td><span class="px-2 py-0.5 rounded-full text-[10px] font-bold ${s.c}">${s.s}</span></td><td class="p-3"><button onclick="eA('${x.id}')" class="text-blue-600 mr-2">Edit</button><button onclick="dA('${x.id}','${x.no}')" class="text-red-600">X</button></td></tr>`)})};window.hS=async e=>{e.preventDefault();const i=_('aI').value,d={no:_('no').value,ap:_('ap').value,ci:_('ci').value,te:_('te').value,fN:_('fN').value,ca:_('ca').value,nc:parseInt(_('nc').value)||null,pe:parseFloat(_('pe').value),ta:parseFloat(_('ta').value),tN:_('tN').value,fP:_('fP').value,uP:_('uP').value,mP:parseFloat(_('mP').value)||0,clubId:tI,uA:new Date().toISOString()};try{if(i)await uD(dO(db,'club_athletes',i),d);else await aD(cL(db,'club_athletes'),d);alert('OK');rF()}catch(x){alert(x.message)}};window.eA=i=>{const a=cA.find(x=>x.id===i);_('aI').value=a.id;_('no').value=a.no;_('ap').value=a.ap;_('ci').value=a.ci;_('te').value=a.te;_('fN').value=a.fN;_('ca').value=a.ca;_('nc').value=a.nc;_('pe').value=a.pe;_('ta').value=a.ta;_('tN').value=a.tN;_('fP').value=a.fP||'mensual';_('mP').value=a.mP||0;_('uP').value=a.uP||'';uL();window.scrollTo(0,0)};window.dA=async(i,n)=>{if(confirm(`¿Eliminar ${n}?`))await dD(dO(db,'club_athletes',i))};window.rF=()=>{_('aF').reset();_('aI').value='';uL()};oA(auth,async u=>{if(u){const d=await gD(dO(db,"users",u.uid));tI=d.exists()?d.data().teamId:null;if(tI)oS(qR(cL(db,'club_athletes'),wH("clubId","==",tI)),s=>{cA=s.docs.map(x=>({id:x.id,...x.data()}));rT(cA)});else window.location.href='index.html'}else window.location.href='index.html'});window.logout=()=>sO(auth).then(()=>location.href='index.html');</script></body></html>
